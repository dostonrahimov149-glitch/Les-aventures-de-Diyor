<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapitre 9 â€“ Les mots cachÃ©s</title>
<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:linear-gradient(to bottom,#0b1d3a,#000);
  color:white;
  text-align:center;
}
.page{max-width:480px;margin:auto;padding:40px 16px;}
h2{font-size:26px}
.hint{font-size:18px;opacity:.9;margin:10px 0 20px}
.letters,.slots{
  display:flex;flex-wrap:wrap;gap:10px;
  justify-content:center;margin:20px 0
}
.letter{
  width:48px;height:48px;border-radius:12px;
  background:#2b7cff;color:white;
  display:flex;align-items:center;justify-content:center;
  font-size:22px;cursor:pointer;
}
.slot{
  width:48px;height:48px;border:2px dashed #6fb3ff;
  border-radius:12px;display:flex;align-items:center;justify-content:center;
  font-size:22px
}

.overlay{
  position:fixed;inset:0;
  background:rgba(0,0,0,.85);
  display:none;align-items:center;justify-content:center;flex-direction:column;
  z-index:999;
}
.overlay img{
  max-width:90%;max-height:70%;border-radius:16px;
}
#bravo{
  font-size:36px;
  margin-bottom:16px;
}
.confetti{
  position:absolute;
  width:8px;height:8px;border-radius:50%;
  animation: fall 1.2s linear forwards;
}
@keyframes fall{
  from{transform:translateY(-20px);opacity:1}
  to{transform:translateY(300px);opacity:0}
}
.btn{
  margin-top:24px;padding:16px 40px;border:none;border-radius:22px;
  background:#2b7cff;color:white;font-size:20px;font-weight:bold;
}
</style>
</head>
<body>

<audio id="clickSound" src="sounds/click.mp3"></audio>
<audio id="successSound" src="sounds/success.mp3"></audio>

<div class="page">
  <h2>ðŸ”Ž Trouve le mot cachÃ©</h2>
  <div class="hint" id="hint"></div>
  <div class="slots" id="slots"></div>
  <div class="letters" id="letters"></div>
</div>

<div class="overlay" id="overlay">
  <div id="bravo">Bravo !</div>
  <img id="img" src="">
</div>

<script>
const steps = [
  { w:"SEINE", img:"seine.jpg", hint:"ðŸŒŠ Câ€™est un fleuve. Il traverse le cÅ“ur de Paris." },
  { w:"LOUVRE", img:"louvre.jpg", hint:"ðŸ›ï¸ Câ€™est un grand musÃ©e. On y trouve des trÃ©sors du monde." },
  { w:"MONTMARTRE", img:"montmartre.jpg", hint:"ðŸŒ™ Câ€™est une colline. La nuit, Paris y brille." }
];

let index = 0;
let current = "";

function shuffle(arr){ return arr.sort(()=>Math.random()-0.5); }

function loadWord(){
  current = "";
  const data = steps[index];
  document.getElementById("hint").innerText = data.hint;

  const slots = document.getElementById("slots");
  const letters = document.getElementById("letters");
  slots.innerHTML = "";
  letters.innerHTML = "";

  data.w.split("").forEach(()=> {
    const s = document.createElement("div");
    s.className="slot";
    slots.appendChild(s);
  });

  shuffle(data.w.split("")).forEach(ch=>{
    const l = document.createElement("div");
    l.className="letter";
    l.textContent=ch;
    l.onclick=()=>pick(ch,l);
    letters.appendChild(l);
  });
}

function pick(ch, el){
  document.getElementById("clickSound").play();

  const slots = document.querySelectorAll(".slot");
  for(let s of slots){
    if(!s.textContent){
      s.textContent = ch;
      el.style.visibility="hidden";
      current += ch;
      break;
    }
  }

  if(current.length === steps[index].w.length){
    if(current === steps[index].w){
      document.getElementById("successSound").play();
      showImage();
    } else {
      setTimeout(reset, 600);
    }
  }
}

function reset(){
  current = "";
  document.querySelectorAll(".slot").forEach(s=>s.textContent="");
  document.querySelectorAll(".letter").forEach(l=>l.style.visibility="visible");
}

function confetti(){
  for(let i=0;i<40;i++){
    const c = document.createElement("div");
    c.className="confetti";
    c.style.left = Math.random()*100 + "%";
    c.style.top = "20%";
    c.style.background = ["#ff0","#0ff","#f0f","#0f0","#f00"][Math.floor(Math.random()*5)];
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),1200);
  }
}

function showImage(){
  const ov = document.getElementById("overlay");
  const img = document.getElementById("img");
  img.src = steps[index].img;
  ov.style.display="flex";
  confetti();

  setTimeout(()=>{
    ov.style.display="none";
    index++;
    if(index < steps.length){
      loadWord();
    } else {
      document.querySelector(".page").innerHTML =
        `<h2>ðŸŒ™ Continue ton voyage Ã  travers Parisâ€¦</h2>
         <p style="font-size:20px;opacity:.9">
           Chaque rue cache un secret.<br>
           Chaque pas est une nouvelle aventure.
         </p>
         <img src="diyor-night.jpg" style="width:80%;max-width:320px;border-radius:16px;margin:20px 0;">
         <button class="btn" onclick="location.href='chapter10.html'">Continuer â†’</button>`;
    }
  },7000);
}

loadWord();
</script>

</body>
</html>
