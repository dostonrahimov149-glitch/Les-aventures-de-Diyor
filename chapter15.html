<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapitre 15 ‚Äì Les murs parlent</title>

<style>
body{
  margin:0;
  font-family: "Cinzel", "Times New Roman", serif;
  background:black;
  color:white;
  text-align:center;
}

.back{
  position:fixed;top:12px;left:12px;
  color:#6fb3ff;text-decoration:none;font-size:14px;
  z-index:10;
}

.scene{
  min-height:100vh;
  background:url("wall-catacombe.jpeg") center/cover no-repeat;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  align-items:center;
  padding:40px 16px;
}

h2{
  margin-top:40px;
  font-size:28px;
  letter-spacing:1px;
  text-shadow:0 0 12px rgba(255,200,120,.8);
}

.instruction{
  margin:14px 0 24px;
  font-size:20px;
  opacity:.95;
  text-shadow:0 0 10px rgba(255,220,150,.8);
}

.words, .slots{
  display:flex;
  flex-wrap:wrap;
  gap:14px;
  justify-content:center;
  margin:14px 0;
}

.word, .slot{
  padding:12px 18px;
  border-radius:14px;
  font-size:22px;
  font-weight:bold;
}

.word{
  background:rgba(255,200,120,.15);
  color:#fff6e0;
  border:1px solid #ffd08a;
  cursor:pointer;
  box-shadow:0 0 18px rgba(255,190,100,.9);
}

.slot{
  min-width:110px;
  min-height:44px;
  border:2px dashed rgba(255,220,150,.8);
}

#msg{
  margin-top:18px;
  min-height:28px;
  font-size:20px;
  text-shadow:0 0 10px rgba(255,200,120,.8);
}

.shake{
  animation:shake .4s;
}

@keyframes shake{
  0%{transform:translateX(0)}
  25%{transform:translateX(-6px)}
  50%{transform:translateX(6px)}
  75%{transform:translateX(-6px)}
  100%{transform:translateX(0)}
}

.btn{
  margin-top:34px;
  padding:16px 40px;
  border:none;
  border-radius:22px;
  background:#2b7cff;
  color:white;
  font-size:20px;
  font-weight:bold;
  display:none;
}
</style>
</head>

<body>

<a class="back" href="chapter14.html">‚Üê Retour</a>

<div class="scene" id="scene">
  <h2 id="title">ü™® Mur 1</h2>
  <div class="instruction">
    Remets les mots dans le bon ordre pour ouvrir le passage.
  </div>

  <div class="slots" id="slots"></div>
  <div class="words" id="words"></div>
  <div id="msg"></div>

  <button class="btn" id="next" onclick="location.href='chapter16.html'">
    Continuer ‚Üí
  </button>
</div>

<script>
const walls = [
  {
    parts:["ancien","est","ce","tunnel"],
    answer:"ce tunnel est ancien",
    error:"Essaie encore‚Ä¶"
  },
  {
    parts:["silencieux","est","cet","endroit"],
    answer:"cet endroit est silencieux",
    error:"Le mur reste ferm√©‚Ä¶"
  },
  {
    parts:["froid","est","ce","lieu"],
    answer:"ce lieu est froid",
    error:"Les ombres bougent‚Ä¶ R√©essaie."
  }
];

let index = 0;
let current = [];

function shuffle(a){ return a.sort(()=>Math.random()-0.5); }

function normalize(str){
  return str.toLowerCase().replace(/\s+/g," ").trim();
}

function loadWall(){
  const w = walls[index];
  current = [];
  document.getElementById("title").innerText = `ü™® Mur ${index+1}`;
  document.getElementById("msg").innerText = "";

  const slots = document.getElementById("slots");
  const words = document.getElementById("words");
  slots.innerHTML = "";
  words.innerHTML = "";

  w.parts.forEach(()=> {
    const s = document.createElement("div");
    s.className = "slot";
    slots.appendChild(s);
  });

  shuffle([...w.parts]).forEach(p=>{
    const d = document.createElement("div");
    d.className = "word";
    d.innerText = p;
    d.onclick = ()=>pick(p,d);
    words.appendChild(d);
  });
}

function pick(word, el){
  const slots = document.querySelectorAll(".slot");
  for(let s of slots){
    if(!s.textContent){
      s.textContent = word;
      el.style.visibility="hidden";
      current.push(word);
      break;
    }
  }

  if(current.length === walls[index].parts.length){
    check();
  }
}

function check(){
  const sentence = normalize(current.join(" "));
  const target = normalize(walls[index].answer);

  if(sentence === target){
    setTimeout(()=>{
      index++;
      if(index < walls.length){
        loadWall();
      } else {
        document.getElementById("slots").style.display="none";
        document.getElementById("words").style.display="none";
        document.getElementById("title").innerText = "‚ú® Les murs s‚Äôouvrent‚Ä¶";
        document.querySelector(".instruction").innerText =
          "Un passage secret appara√Æt devant Diyor.";
        document.getElementById("next").style.display="inline-block";
      }
    },600);
  } else {
    const sc = document.getElementById("scene");
    sc.classList.add("shake");
    document.getElementById("msg").innerText = walls[index].error;
    setTimeout(()=>{
      sc.classList.remove("shake");
      reset();
    },400);
  }
}

function reset(){
  current = [];
  document.querySelectorAll(".slot").forEach(s=>s.textContent="");
  document.querySelectorAll(".word").forEach(w=>w.style.visibility="visible");
}

loadWall();
</script>

</body>
</html>
